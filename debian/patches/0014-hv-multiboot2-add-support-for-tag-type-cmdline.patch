From 0a960eb3be921e863b6bc646b95906d2acf468b1 Mon Sep 17 00:00:00 2001
From: Helmut Buchsbaum <helmut.buchsbaum@opensource.tttech-industrial.com>
Date: Thu, 7 May 2020 14:20:06 +0200
Subject: [PATCH 14/18] hv: multiboot2: add support for tag type cmdline

To be able to add a command line like for multiboot1 add support for
the multiboot2 tag cmdline (1).

Signed-off-by: Helmut Buchsbaum <helmut.buchsbaum@opensource.tttech-industrial.com>
---
 hypervisor/boot/multiboot2.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/hypervisor/boot/multiboot2.c b/hypervisor/boot/multiboot2.c
index 0136ad68..004e8d44 100644
--- a/hypervisor/boot/multiboot2.c
+++ b/hypervisor/boot/multiboot2.c
@@ -102,6 +102,10 @@ int32_t multiboot2_to_acrn_mbi(struct acrn_multiboot_info *mbi, void *mb2_info)
 		}
 
 		switch (mb2_tag->type) {
+		case MULTIBOOT2_TAG_TYPE_CMDLINE:
+			mbi->mi_cmdline = ((struct multiboot2_tag_string *)mb2_tag)->string;
+			mbi->mi_flags |= MULTIBOOT_INFO_HAS_CMDLINE;
+			break;
 		case MULTIBOOT2_TAG_TYPE_MMAP:
 			mb2_mmap_to_mbi(mbi, (struct multiboot2_tag_mmap *)mb2_tag);
 			break;
-- 
2.20.1

